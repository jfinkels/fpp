%% fpp.tex - fixed-parameter parallelizability
%%
%% Copyright 2016 Jeffrey Finkelstein.
%%
%% This LaTeX markup document is made available under the terms of the Creative
%% Commons Attribution-ShareAlike 4.0 International License,
%% https://creativecommons.org/licenses/by-sa/4.0/.
\documentclass{article}

\usepackage{amsmath}
\usepackage{amssymb}
%% This must come before hyperref.
\usepackage{amsthm}
%% This is strongly recommended by biblatex.
\usepackage[english]{babel}
\usepackage[backend=biber]{biblatex}
\usepackage[T1]{fontenc}
%% This must come before csquotes.
\usepackage[utf8]{inputenc}
\usepackage{lmodern}
%% This is strongly recommended by biblatex.
\usepackage{csquotes}
%% This must come before hyperref.
\usepackage{thmtools}
%% This must come before complexity.
\usepackage{hyperref}
\usepackage{complexity}
\usepackage[firstpage]{draftwatermark}
\usepackage[final]{microtype}
\usepackage{textcomp}

%% Set the amount by which certain characters protrude into the margins.
%%
%% \LoadMicrotypeFile{cmr}
%%
%%     This command forces the built-in protrusion settings for the Computer
%%     Modern Roman (cmr) font family to become available at this point, so
%%     that we can override these settings on the next line. Even though we are
%%     really using the Latin Modern Roman (lmr) fonts, microtype uses the cmr
%%     configuration file.
%%
%% \SetProtrusion
%%
%%     This instructs the microtype package that we are going to modify the
%%     protrusion settings.
%%
%% [load=lmr-T1]
%%
%%     Loads the Type 1 (T1) encoding of the lmr font family, thereby setting
%%     the default protrusion values for all the characters. This is only
%%     possible after the \LoadMicrotypeFile{cmr} command (microtype
%%     essentially considers lmr to be an alias for cmr).
%%
%% {encoding=T1, family=lmr}
%%
%%     Indicates that we are going to modify the protrusion values for the T1
%%     encoding of the lmr font family.
%%
%% \textquotedblright = {,1000} (and similar commands)
%%
%%     Force the character given by \textquotedblright to have default
%%     protrusion on the left margin (given by an empty string before the
%%     comma) and full protrusion (that is, protrusion value 1000) on the right
%%     margin.
\LoadMicrotypeFile{cmr}
\SetProtrusion
    [load=lmr-T1]
    {encoding=T1, family=lmr}
    {
      \textquotedblright = {,1000},
      \textquotedblleft = {1000,},
      {'} = {,1000},
      {,} = {,1000},
      {:} = {,1000},
      {;} = {,1000},
      {.} = {,1000}
    }

%% Set the ``work-in-progress'' watermark for the first page.
\SetWatermarkLightness{0.9}
\SetWatermarkText{Work-in-progress}
\SetWatermarkFontSize{3.5cm}

%% Set the title and author of the PDF file.
\hypersetup{pdftitle={Fixed-parameter parallelizability}, pdfauthor={Jeffrey Finkelstein}}

%% Declare the bibliography file.
\addbibresource{fpp.bib}

%% Declare theorem- and proof-like environments.
\declaretheorem[numberwithin=section]{theorem}
\declaretheorem[numberlike=theorem]{lemma}
\declaretheorem[numberlike=theorem]{conjecture}
\declaretheorem[numberlike=theorem]{corollary}
\declaretheorem[numberlike=theorem]{proposition}
\declaretheorem[numberlike=theorem]{assumption}
\declaretheorem[numberlike=theorem, style=definition]{definition}
\newenvironment{justification}{\begin{proof}[Justification]}{\end{proof}}

%% Custom commands are declared here.
\newcommand{\email}[1]{\textlangle\href{mailto:#1}{\nolinkurl{#1}}\textrangle}
\newcommand{\todo}[1]{\textbf{TODO #1}}

%%%% Commands for parameterized problem names.
\newcommand{\dash}{\textnormal{-}}
\newcommand{\pncsat}{p\dash\log\dash\NC^d\dash\textsc{Circuit Sat}}
\newcommand{\pgrouprank}{p\dash\textsc{Group Rank}}
\newcommand{\pMC}{p\dash\MC}
\newcommand{\pWD}{p\dash\WD}
\newcommand{\pBHP}{p \dash \textsc{BHP}}
\newcommand{\pSCE}{p \dash \textsc{SCE}}
\newcommand{\pHDS}{p \dash \textsc{HDS}}
\newcommand{\pCkSAT}{p \dash k \dash \textsc{CSat}}
\newcommand{\pCkE}{p \dash k \dash \textsc{CE}}
\newcommand{\pWCE}{p \dash \textsc{WCE}}
\newcommand{\pPiFSAT}{p \dash \Pi_t \textsc{FSat}}
\newcommand{\PiFSAT}{\Pi_t \textsc{FSat}}
\newcommand{\PiCSAT}{\Pi_t \textsc{CSat}}

%%%% Custom math commands.
\newcommand{\ceil}[1]{\lceil{#1}\rceil}
\newcommand{\gen}[1]{\langle#1\rangle}
\newcommand{\cl}[1]{\left[{#1}\right]}
\DeclareMathOperator{\depth}{depth}
\DeclareMathOperator{\nondet}{nondet}
\DeclareMathOperator{\size}{size}
\DeclareMathOperator{\Var}{Var}

%% Redefine the footnote environment so it has no reference and no number.
\long\def\symbolfootnote#1{\begingroup%
\def\thefootnote{\fnsymbol{footnote}}\footnotetext{#1}\endgroup}

%% Define the author, title, and date for the document.
\author{Jeffrey~Finkelstein\\ Computer Science Department, Boston University}
\title{Fixed-parameter parallelizability}

\begin{document}

\maketitle

\symbolfootnote{%
  Copyright 2016 Jeffrey~Finkelstein \email{jeffreyf@bu.edu}.

  This document is licensed under the Creative Commons Attribution-ShareAlike 4.0 International License, which is available at \mbox{\url{https://creativecommons.org/licenses/by-sa/4.0/}}.
  The \LaTeX{} markup that generated this document can be downloaded from its website at \mbox{\url{https://github.com/jfinkels/fpp}}.
  The markup is distributed under the same license.
}

\tableofcontents

\section{Introduction}

%% Document content goes here.
%
% Global components at each level must follow this structure.
%
% % Foreword %
%
% %% Context (anyone - why now?) %%
%
% What is the current situation, and why is the need so important?
%
%
% %% Need (readers - why you?) %%
%
% Why is this relevant to the reader, and why does something need to be done?
% (Also reference relevant existing work.)
%
%
% %% Task (author - why me?) %%
%
% What was undertaken to address the need?
%
%
% %% Object (document - why this document?) %%
%
% What does this document cover?
%
%
% % Summary %
%
% %% Findings (author - what?)
%
% What did the work reveal when performing the task?
We show the existence of a $\P$-complete problem in $\para \NC$ (the circuit evaluation problem parameterized by depth \autoref{thm:cvpdepth}) and a $\P$-complete problem not in $\para \P$, unless $\NC = \P$ (the ``small'' circuit evaluation problem \autoref{thm:psce}).
We prove that $\para \NC = \para \WNC$ almost exactly when $\NC = \NNC[i(n) \log n]$ \autoref{sec:fppwpp}.
%
%
% %% Conclusion (readers - so what?)
%
% What did the findings mean for the audience?
%
%
% %% Perspective (anyone - what now?)
%
% What should be done next?

\section{Definitions}

\begin{definition}
  A \emph{Boolean circuit}, or simply a \emph{circuit}, $C$, is an directed acyclic graph.
  The \emph{size of a circuit}, denoted $\size(C)$, is the number of vertices in the underlying graph.
  The \emph{depth of a circuit}, denoted $\depth(C)$, is the length of a longest path from the root to a sink.
\end{definition}

\begin{definition}
  A function $f$ is \emph{circuit-computable} if there is a nonuniform family of Boolean circuits $\{C_n\}_{n \in \mathbb{N}}$ such that for each $x$ we have $f(x) = C_n(x)$, where $n = |x|$.

  A language is \emph{circuit-decidable} if it has a circuit-computable characteristic function.
  We may also require that the size and depth of each circuit $C_n$ in the family be circuit-computable from just $n$, the length of the input.
  In this case, we say the language is \emph{circuit-decidable with uniform size and depth}.
\end{definition}

Nonuniformity is required in \autoref{thm:eventually} and \autoref{thm:rmparam}, among other theorems, in which the size of the input relative to the size of the parameter for an instance of the parameterized problem selects which of two circuits to use.
If the circuits were uniform, we would need to include both alternatives as subcircuits of a single larger circuit, thereby making the circuits too deep to meet the required circuit depth bounds.

\begin{definition}[Decision problems and parameterized problems]
  A \emph{language} is a set of binary strings.
  A \emph{parameterization} is a computable function $\kappa$ from binary strings to natural numbers.
  A \emph{parameterized problem} is a pair $(Q, \kappa)$, where $Q$ is a language and $\kappa$ is a parameterization.
\end{definition}

\begin{definition}[Slices of parameterized problems]
  For each positive integer $k$ and each parameterized problem $(Q, \kappa)$, the \emph{$k$th slice of $Q$}, denoted $(Q, \kappa)_k$, is defined by
  \[
  (Q, \kappa)_k = \{(x, k) \, | \, x \in Q \text{ and } \kappa(x) = k\}.
  \]
\end{definition}

\begin{definition}[$\NNC^d$ and $\NC^d$]
  Let $d$ be a natural number.
  A language $Q$ is in the class $\NNC^d[b(n)]$ if there is a nondeterministic circuit family $\{C_n\}$ such that for each string $x$ of length $n$,
  \begin{itemize}
  \item $x \in Q$ if and only if $C_n(x) = 1$,
  \item $\size(C_n) \leq n^{O(1)}$,
  \item $\depth(C_n) \leq O(\log^d n)$,
  \item $\nondet(C_n) \leq b(n)$.
  \end{itemize}
  If $b$ is the zero function, then the language is in the class $\NC^d$.
\end{definition}

Throughout we will often assume without loss of generality that functions like circuit size and depth bounds, nondeterministism bounds, and polynomials, are increasing

\section{Fixed-parameter parallelizability}
\label{sec:pcompletefpp}

The $\P$-complete problems are considered tractable but inherently sequential; adding more processors does not provide any significant reduction in the time required to find a solution, even thought they can be solved in polynomial time.
But can the lack of parallelizability for these problems depend on a parameterization of the problem, thereby isolating some of the ``sequential-ness'' of the problem in the value of the parameter?

\subsection{Definition of \texorpdfstring{$\para \NC$}{paraNC}}

\begin{definition}[$\para \NC^d$]
  Let $d$ be a natural number.
  A parameterized problem $(Q, \kappa)$ is in the class $\para \NC^d$ if there is a circuit-computable function $f$ and a nonuniform family $\{C_{n, k}\}$ of bounded fan-in Boolean circuits such that for each string $x$,
  \begin{itemize}
  \item $x \in Q$ if and only if $C_{n, k}(x) = 1$, where $n = |x|$ and $k = \kappa(x)$,
  \item $\size(C_{n, k}) \leq f(k) n^{O(1)}$,
  \item $\depth(C_{n, k}) \leq f(k) + O(\log^d n)$.
  \end{itemize}
  If instead the depth is bounded by $f(k) O(\log^d n)$, the class is denoted $\para \NC^{d \uparrow}$, a superclass of $\para \NC^d$.

  If the circuits are of unbounded fan-in, the classes are $\para \AC^d$ and $\para \AC^{d \uparrow}$, respectively.
\end{definition}

The classes $\para \AC^{d \uparrow}$ were first defined in \autocite{bst15}.

\subsection{Example problem in \texorpdfstring{$\para \NC$}{paraNC}}

The parameterized vertex cover problem is in $\para \AC^0$ \autocite{bst15}, but the underlying decision problem is $\NP$-complete.
We are interested in finding a problem in $\para \NC$ whose underlying decision problem is $\P$-complete.
One way to do this is to choose $Q$ to be a $\P$-complete problem and $\kappa$ to be the ``degenerate'' parameterization function $\kappa(x) = |x|$.

\begin{definition}[$p \dash s \dash \textsc{Circuit Evaluation}$]
  \mbox{} \\
  \begin{tabular}{r p{9.2cm}}
    \textbf{Instance:} & Boolean circuit $C$ on $n$ inputs, with size $m$ and depth $d$. \\
    \textbf{Parameter:} & $m$. \\
    \textbf{Question:} & Does $C(x) = 1$?
  \end{tabular}
\end{definition}

\begin{theorem}
  $p \dash s \dash \textsc{Circuit Evaluation}$ is in $\para \NC$ and the underlying decision problem is $\P$-complete.
\end{theorem}
\begin{proof}
  The circuit evaluation problem is $\P$-complete by \autocite{ladner75}.
  Since the parameterization is monotonically increasing with the size of the input, the problem is in $\para \NC$ by the technique of \autocite[Proposition~1.7]{fg06}.
\end{proof}

To find a non-degenerate example, we can parameterize the circuit evaluation problem by depth instead of size.

\begin{definition}[$p \dash d \dash \textsc{Circuit Evaluation}$]
  \mbox{} \\
  \begin{tabular}{r p{9.2cm}}
    \textbf{Instance:} & Boolean circuit $C$ on $n$ inputs, with size $m$ and depth $d$. \\
    \textbf{Parameter:} & $d$. \\
    \textbf{Question:} & Does $C(x) = 1$?
  \end{tabular}
\end{definition}

\begin{theorem}\label{thm:cvpdepth}
  $p \dash d \dash \textsc{Circuit Evaluation}$ is in $\para \AC^{0 \uparrow}$ and the underlying decision problem is $\P$-complete.
\end{theorem}
\begin{proof}
  As stated in the proof of the previous theorem, the circuit evaluation problem is $\P$-complete.
  Evaluating the circuit $C$ of size $m$ and depth $d$ on inputs $x$ can be performed by the depth-universal circuit $U$ of \autocite{ch85}.
  The size of $U$ is $O(m)$ and the depth is $O(m)$, so if we choose $f$ to be sufficiently large, then the size is bounded by $f(d) m^{O(1)}$ and the depth by $f(d)$.
  Therefore the circuit evaluation problem parameterized by circuit depth is in $\para \AC^{0 \uparrow}$.
\end{proof}

\subsection{Relationship between \texorpdfstring{$\para \NC$}{paraNC} and \texorpdfstring{$\NC$}{NC}}

\begin{definition}\label{def:eventually}
  Suppose $d$ is a natural number and $(Q, \kappa)$ is a parameterized problem.
  We say the problem $(Q, \kappa)$ is \emph{eventually in $\NC^d$} if there is a circuit-computable function $h$ and an $\NC^d$ family of circuits $\{C_n\}_{n \in \mathbb{N}}$ such that for each $x$ of length $n$, if $n \geq h(\kappa(x))$, then $x \in Q$ if and only if $C_n(x) = 1$.
\end{definition}

This theorem is a characterization of parameterized problems in the class $\para \NC^d$ as problems for which the parameter suggests an input size threshold, below which it suffices to perform an exhaustive search to solve the problem and after which we require an efficient algorithm.
It is the adaptation of \autocite[Theorem~1.37]{fg06}.

\begin{theorem}\label{thm:eventually}
  Suppose $d$ is a natural number and $(Q, \kappa)$ is a parameterized problem.
  If $Q$ is circuit-decidable with uniform size and depth and $(Q, \kappa)$ is eventually in $\NC^d$, then $(Q, \kappa)$ is in $\para \NC^d$.
\end{theorem}
\begin{proof}
  Let $h$ be the function that defines the lower bound on the length after which $(Q, \kappa)$ is in $\NC^d$.
  The nonuniform family of circuits $\{A_{n, k}\}$ that decides $(Q, \kappa)$ is defined by
  \[
  A_{n, k} =
  \begin{cases}
    C^1_n & \text{if } n < h(k) \\
    C^2_n & otherwise,
  \end{cases}
  \]
  where $\{C^1_n\}$ is the family of circuits that decides $Q$ and $\{C^2_n\}$ is the family of $\NC^d$ circuits that eventually decides $(Q, \kappa)$.
  The correctness of $A_{n, k}$ follows from the correctness of $C^1_n$ and $C^2_n$.

  Let $S$ and $D$ be the circuit-computable functions that give the size and depth, respectively, of $C^1_n$ from $n$.
  If $n < h(k)$, then
  \begin{align*}
    \size(A_{n, k}) & = \size(C^1_n) = S(n) \leq S(h(k)), \\
    \depth(A_{n, k}) & = \depth(C^1_n) = D(n) \leq D(h(k)).
  \end{align*}
  If $n \geq h(k)$, then
  \begin{align*}
    \size(A_{n, k}) & = \size(C^2_n) = n^{O(1)}, \\
    \depth(A_{n, k}) & = \depth(C^2_n) = O(\log^d n).
  \end{align*}
  An upper bound for the size of $A_{n, k}$ in either case is $S(h(k)) n^{O(1)}$ and for the depth $D(h(k)) + O(\log^d n)$.
  Since $S$ and $D$ are computable, composing each with $h$ yields another computable function, so these size and depth bounds meet the requirements of the definition of $\para \NC^d$.
\end{proof}

\begin{definition}\label{def:spreduction}
  Suppose $d$ is a natural number, $(Q, \kappa)$ is a parameterized problem, and $Q'$ is a decision problem.
  There is a \emph{small parameter $\NC^d$ many-one reduction} from $(Q, \kappa)$ to $Q'$ if there is a nondecreasing, unbounded, circuit-computable function $h$ and an $\NC^d$ family of circuits $\{R_n\}_{n \in \mathbb{N}}$ such that for each string $x$ of length $n$ with $\kappa(x) \leq h(n)$, we have $x \in Q$ if and only if $R_n(x) \in Q'$.
\end{definition}

\begin{lemma}\label{lem:upperinverse}
  Suppose $i$ is an unbounded, nondecreasing, circuit-computable function.
  Then there is an unbounded, nondecreasing, circuit-computable function $f_i$ such that for each natural number $n$, we have $f_i(i(n)) \geq n$.
  (We call $f_i$ the ``upper inverse'' of $i$.)
  \todo{Make this look like the inverse lemma.}
\end{lemma}
\begin{proof}
  \todo{Fill me in}
\end{proof}

This lemma is analogous to \autoref{thm:eventually}.
It demonstrates that the closure of $\NC$ under small parameter reductions is $\para \NC$.

\begin{lemma}\label{lem:spreduction}
  Suppose $d$ is a natural number, $(Q, \kappa)$ is a parameterized problem, and $Q'$ is a decision problem.
  If $Q$ is circuit-decidable with uniform size and depth, $Q'$ is in $\NC^d$, and there is a small parameter $\NC^d$ many-one reduction from $(Q, \kappa)$ to $Q'$, then $Q$ is in $\para \NC^d$.
\end{lemma}
\begin{proof}
  Let $h$ be the function that defines the upper bound on the parameter, below which there is an $\NC^d$ many-one reduction from $Q$ to $Q'$.
  Let $\{R_n\}$ be the $\NC^d$ circuit family computing the reduction.
  The nonuniform family of circuits $\{A_{n, k}\}$ that decides $(Q, \kappa)$ is defined by
  \[
  A_{n, k} =
  \begin{cases}
    C_n^1 & \text{if } h(n) < k \\
    C_{n'}^2 \circ R_{n} & \text{otherwise},
  \end{cases}
  \]
  where $\{C_n^1\}$ is the family of circuits that decides $Q$ with uniform size and depth, $\{C_n^2\}$ is the family of $\NC^d$ circuits that decides $Q'$, and $n'$ is the number of output bits of $R_n$.
  The correctness of $A_{n, k}$ follows from the correctness of the subsequent circuits.

  If $h(n) \geq k$, then the size and depth of the circuit are polynomial and polylogarithmic in $n$, respectively, because the size and depth of $C_{n'}^2$ and $R_n$ are.
  For the case when $h(n) < k$, consider the upper inverse $i_h$ of $h$ guaranteed by \autoref{lem:upperinverse}.
  By construction, $n \leq i_h(h(n)) < i_h(k)$.
  Now
  \begin{align*}
    \size(A_{n, k}) & = \size(C_n^1) = S(n) \leq S(i_h(k)), \\
    \depth(A_{n, k}) & = \depth(C_n^1) = D(n) \leq D(i_h(k)),
  \end{align*}
  where $S$ and $D$ are the (circuit-computable, nondecreasing) size and depth bounds for the circuit family $\{C_n^1\}$.
  Thus in either case, there is a sufficiently large circuit-computable function $f$ such the size of $A_{n, k}$ is bounded above by $f(k) n^{O(1)}$ and the depth $f(k) + O(\log^d n)$.
\end{proof}

This lemma shows that a many-one reduction to a fixed-parameter parallelizable problem can sometimes induce a highly parallel algorithm, if the parameter functions are bounded for the reduced instance.

\begin{lemma}\label{lem:reducetonc}
  Suppose $d$ is a positive integer, $Q$ is a decision problem, and $(Q', \kappa')$ is a parameterized problem.
  Suppose there is an $\NC^d$ many-one reduction from $Q$ to $Q'$, given by the circuit family $\{R_n\}$, and $(Q', \kappa')$ is in $\para \NC^d$ by a circuit family $\{C_{m, k}\}$ of size $f(k) m^{O(1)}$ and depth $f(k) + O(\log^d m)$ on inputs of length $m$.
  If $f(\kappa'(R_n(x))) \leq \min(n^{O(1)}, O(\log^d n))$, then $Q$ is in $\NC^d$.
\end{lemma}
\begin{proof}
  The circuit family that decides $Q$ is $\{A_n\}$, defined by $A_n = C_{m, k} \circ R_n$, where $m$ is the size of the output of $R_n$ and $k = \kappa'(R_n(x))$.
  Since $\size(R_n) = n^{O(1)}$, we have $m = n^{O(1)}$ as well.
  For correctness,
  \[
  x \in Q \iff R_n(x) \in Q' \iff C_{m, k}(R_n(x)) = 1.
  \]
  For size and depth bounds,
  \begin{align*}
    \size(A_n) & = \size(C_{m, k}) + \size(R_n) \\
    & = f(k) m^{O(1)} + n^{O(1)} \\
    & = f(k) n^{O(1)} + n^{O(1)} \\
    & = n^{O(1)} n^{O(1)} + n^{O(1)} \\
    & = n^{O(1)},
  \end{align*}
  and
  \begin{align*}
    \depth(A_n) & = \depth(C_{m, k}) + \depth(R_n) \\
    & = f(k) + O(\log^d m) + O(\log^d m) \\
    & = f(k) + O(\log^d m) \\
    & = f(k) + O(\log^d n) \\
    & = O(\log^d n) + O(\log^d n) \\
    & = O(\log^d n). \qedhere
  \end{align*}
\end{proof}

\subsection{Approximable optimization problems}

Yet another way to do this is to find an optimization problem whose budget problem is $\P$-complete while admitting a highly parallel approximation scheme via a ``fixed-parameter parallelizable'' algorithm.

\begin{definition}
  An \emph{optimization problem} $O$ is a four-tuple $(I, S, m, t)$, where $I$ is the set of instances, $S$ is the set of pairs $(x, w)$ where $w$ is a solution for $x$, the function $m$ computes the \emph{measure} (or \emph{objective value}) for such a pair, and $t$ is either $\min$ or $\max$.
\end{definition}

\begin{definition}
  The \emph{standard parameterization} of a minimization problem $O$, denoted $p\dash{O}$, is $(Q, \kappa)$, where $Q = \{ (x, k) \, | \, m^*(x) \leq k \}$ and $\kappa(x, k) = k$.
  The inequality is reversed for a maximization problem.
\end{definition}

\begin{definition}
  Suppose $(I, S, m, t)$ is an optimization problem and $(x, y) \in S$.
  The \emph{performance ratio} of the solution $y$ (with respect to $x$), denoted $R(x, y)$, is defined by
  \[
  R(x, y) = \max \left(\frac{m(x, y)}{m^*(x)}, \frac{m^*(x)}{m(x, y)}\right)
  \]
\end{definition}

The performance ratio $R(x, y)$ is a number in the interval $[1, \infty)$.
The closer $R(x, y)$ is to 1, the better the solution $y$ is for $x$, and the closer $R(x, y)$ to $\infty$, the worse the solution.

\begin{definition}
  An \emph{approximation scheme} for an optimization problem is a function $A$ such that for all $x$ and all positive integers $k$ we have $(x, A(x, k)) \in S$ and $R(x, A(x, k)) \leq 1 + \frac{1}{k}$.
\end{definition}

An approximation scheme induces a family of functions, $\{A_k\}_{k \in \mathbb{N}}$, that form progressively better approximations for the optimization problem.

%% \begin{definition}
%%   An optimization problem $O$ has an \emph{$\NC$ approximation scheme} if there is an approximation scheme $A$ for $O$ such that for each $k$, we have $A_k \in \FNC$, where $A_k(x) = A(x, k)$ for each $x$.
%% \end{definition}

\begin{definition}
  Suppose $O$ is an optimization problem with $O = (I, S, m, t)$ with $I$ and $S$ in $\NC$ and $m$ in $\FNC$.
  An optimization problem $O$ is in $\NCAS$ if there is an approximation scheme $A$ for $O$ such that for each $k$, we have $A_k \in \FNC$, where $A_k(x) = A(x, k)$ for each $x$.
  The problem is in $\FNCAS$ if there is an approximation scheme $A$ for $O$ such that $A \in \FNC$ (i.e. on both inputs).
\end{definition}

This definition is adapted from \autocite[Definition~1.31]{fg06}

\begin{definition}
  An optimization problem $O$ is in $\ENCAS$ if there is a circuit family $\{A_{n, k}\}$ and circuit-computable functions $f$ and $g$ such that
  \begin{itemize}
  \item $\{A_{n, k}\}$ is an approximation scheme for $O$,
  \item $\size(A_{n, k}) \leq f(k) n^{O(1)}$,
  \item $\depth(A_{n, k}) \leq g(k) \log^{O(1)} n$.
  \end{itemize}
\end{definition}

\begin{proposition}\label{prop:encas}
  $\FNCAS \subseteq \ENCAS \subseteq \NCAS$.
\end{proposition}

This theorem is an adaptation of \autocite[Theorem~1.32]{fg06}.

\begin{theorem}\label{thm:encasfpp}
  Let $O$ be an optimization problem.
  If $O$ is in $\ENCAS$, then $p\dash{O}$ is in $\FPP$.
\end{theorem}
\begin{proof}
  Assume without loss of generality that $O$ is a minimization problem; the proof is similar if it is a maximization problem.
  Let $\{m_n\}$ be the $\NC$ circuit family that computes the measure function.
  Let $\{A_{n, k}\}$ be the circuit family such that
  \begin{itemize}
  \item $R(x, A_{n, k}(x, k)) \leq 1 + \frac{1}{k}$ for each $x$ and $k$,
  \item $\size(A_{n, k}) \leq f(k) n^{O(1)}$,
  \item $\depth(A_{n, k}) \leq g(k) \log^{O(1)} n$,
  \end{itemize}
  for some circuit-computable functions $f$ and $g$.
  Define the circuit family $\{C_{n, k}\}$ as
  \[
  C_{n, k}(x, k) = 1 \iff m(x, A_{n, k + 1}(x, k + 1)) \leq k,
  \]
  so $C_{n, k}$ outputs 1 if and only if the approximate solution corresponding to parameter $k + 1$ measures less than $k + 1$.
  (The function $m$ is really a circuit as well, chosen from a family of circuits depending on the number of bits in its inputs.)

  The size of $C_{n, k}$ is $O(\size(m) + \size(A_{n, k + 1}))$, which is $f'(k)n^{O(1)}$ for some circuit-computable function $f'$.
  The depth is $O(\depth(m) + \depth(A_{n, k + 1})$, which is $g'(k + 1) \log^{O(1)} n$ for some circuit-computable function $g'$.
  It remains to show correctness of $C_{n, k}$.

  Let $x$ be a string, let $k$ be a natural number, and let $y = A_{n, k + 1}(x, k + 1)$.
  If $C_{n, k} = 1$, then $m(x, y) \leq k$, so $m^*(k) \leq k$ and therefore $(x, k) \in p \dash O$.
  For the converse, if $C_{n, k} = 0$, then $m(x, y) \geq k + 1$, so
  \[
  m^*(x) \geq \frac{m(x, y)}{1 + \frac{1}{k + 1}} \geq \frac{k + 1}{1 + \frac{1}{k + 1}} = \frac{(k + 1)^2}{k + 2} > k.
  \]
  Thus $(x, k) \notin p \dash O$.
  Therefore, we conclude that $p \dash O$ is in $\FPP$.
\end{proof}

The converse does not hold: the minimum vertex cover problem is a counterexample because it is in $\FPP$ \autocite[Theorem~4.5]{bst15}.
\todo{Show an example of an optimization problem whose budget problem is $\P$-complete and whose standard parameterization is in $\FPP$ but for which no $\ENCAS$ exists.}

Our goal now reduces to finding an optimization problem in $\ENCAS$ whose budget problem is $\P$-complete.
%% There exist problems that are $\P$-complete and have randomized $\FNCAS$ algorithms, so under a derandomization assumption, we can show a problem that fits the requirement.

\begin{definition}[\textsc{Maximum Flow}]
  \mbox{} \\
  \begin{tabular}{r p{9.2cm}}
    \textbf{Instance:} & directed graph $G$, a natural number capacity $c_e$ for each edge $e$, source node $s$, and target node $t$. \\
    \textbf{Solution:} & flow $F$, defined as a real number $F_e$ for each edge $e$ such that $F_e \leq c_e$ and at each vertex the total in-flow is at least the total out-flow. \\
    \textbf{Measure:} & total in-flow at $t$. \\
    \textbf{Type:} & maximization.
  \end{tabular}
\end{definition}

%% edge flows can have weights exponential in n

\begin{theorem}
  If $\NC = \RNC$, then the budget problem for \textsc{Maximum Flow} is $\P$-complete and the standard parameterization is in $\FPP$.
\end{theorem}
\begin{proof}
  The budget problem for \textsc{Maximum Flow} is $\P$-complete \autocite[Problem~A.4.4]{ghr95}.
  The \textsc{Maximum Flow} problem is in randomized $\FNCAS$ \autocite[Theorem~4.5.2]{dsst97}.
  If $\NC = \RNC$, then randomized $\FNCAS$ equals deterministic $\FNCAS$.
  Thus, the problem is in $\ENCAS$, by \autoref{prop:encas}.
  Finally, the standard parameterization is in $\FPP$ by \autoref{thm:encasfpp}.
\end{proof}

\todo{Can the randomization part of the RNC algorithm for MaxFlow be absorbed in the fixed-parameter part of the algorithm?}

% The positive linear programming problem is only in NCAS, not FNCAS.

\section{Fixed-parameter tractability}

What we really care about is the parameterized parallel complexity of problems in $\FPP$, and specifically those with underlying decision problems that are $\P$-complete.
The $\WP$ hierarchy does not capture this.
This is similar to the way $\NNC[\polylog]$ allows us to consider efficient highly parallel verification but does not capture polynomial-time decision.

\subsection{Example problem in \texorpdfstring{\FPT}{FPT}}

Consider the parameterized high degree subgraph problem.

\begin{definition}[$p \dash \textsc{High Degree Subgraph}$, aka $\pHDS$]
  \mbox{} \\
  \begin{tabular}{r p{9.2cm}}
    \textbf{Instance:} & undirected graph $G$, positive integer $d$. \\
    \textbf{Parameter:} & $d$. \\
    \textbf{Question:} & Does $G$ have a vertex-induced subgraph of minimum degree at least $d$?
  \end{tabular}
\end{definition}

The underlying decision problem is in $\P$, so the parameterized problem is fixed-parameter tractable.

\begin{theorem}[{\autocite{am84}}]
  $\pHDS$ is in $\FPT$.
\end{theorem}

The first two slices of the problem are in $\NC$, whereas all other slices are $\P$-complete.

\begin{theorem}[{\autocite{am84}}]
  \mbox{}
  \begin{enumerate}
  \item Both $p\dash\textsc{HDS}_1$ and $p \dash \textsc{HDS}_2$ are in $\NC$.
  \item For each positive integer $d$ greater than two, $p \dash \textsc{HDS}_d$ is $\P$-complete.
  \end{enumerate}
\end{theorem}

%% As a maximization problem, the problem is approximable to within a certain constant factor, but inapproximable beyond that factor (unless $\NC = \P$) \autocite{am84}.

\todo{Is this problem FPT-complete? Is it in E[P]?}

\subsection{Completeness in \texorpdfstring{\FPT}{FPT}}

We define $\P$-completeness so that problems that are $\P$-complete are unlikely to see a significant decrease in time complexity when parallelism is allowed, under the assumption that $\NC \neq \P$.
Let us define $\FPT$-completeness similarly, so that $\FPT$-complete problems are unlikely to see a significant decrease in ``parameterized'' time complexity when ``parameterized'' parallelism is allowed, under the assumption that $\FPP \neq \FPT$.
We already know that each $\P$-complete problem induces a $\FPT$-complete problem with a trivial parameterization \autocite[Proposition~14]{fg03}, however we are interested in natural problems with non-trivial parameterizations.
This subsection proves the existence of nontrivial parameterized problems that are not in $\FPP$ (under the assumption $\FPP \neq \FPT$) and whose underlying decision problems are $\P$-complete, complementing \autoref{sec:pcompletefpp}, which proves the existence of parameterized problems in $\FPP$ whose underlying decision problems are $\P$-complete.

The assumption $\FPP \neq \FPT$ is reasonable because it is equivalent to the inequality $\NC \neq \P$.

\begin{proposition}
  $\FPP = \FPT$ if and only if $\NC = \P$.
\end{proposition}
\begin{proof}
  The proof is trivial if we use the equivalent definitions of the complexity class $\FP \mathcal{C}$ as the class of all parameterized problems $(Q, \kappa)$ for which there is a language $L$ in the complexity class $\mathcal{C}$ such that $x \in Q$ if and only if $(x, 1^{f(\kappa(x))}) \in L$.
  See \autocite{fg03}, for example.
\end{proof}


\begin{definition}[$\FPT$-completeness]
  A parameterized problem $(Q, \kappa)$ is \emph{$\FPT$-hard} if for each parameterized problem $(R, \lambda)$, there is an $\FPP$ many-one reduction from $(R, \lambda)$ to $(Q, \kappa)$.
  If furthermore $(Q, \kappa)$ is in $\FPT$, then it is \emph{$\FPT$-complete}.
\end{definition}

\begin{proposition}
  If an $\FPT$-complete problem is in $\FPP$, then $\FPP = \FPT$.
\end{proposition}
\begin{proof}
  Follows from the downward closure of $\FPP$ under $\FPP$ many-one reductions.
\end{proof}

The following problem is adapted from \textsc{Short Deterministic Turing Machine Computation} in \autocite{cesati06}.

\begin{definition}[$p \dash \textsc{Bounded Halting Problem}$, aka $\pBHP$]
  \mbox{} \\
  \begin{tabular}{r p{9.2cm}}
    \textbf{Instance:} & deterministic Turing machine $M$, binary string $x$ of length $n$, positive integer $t$ in unary, positive integer $c$. \\
    \textbf{Parameter:} & $t / n^c$ \\
    \textbf{Question:} & Does $M$ accept $x$ within $t$ steps?
  \end{tabular}
\end{definition}

\begin{theorem}
  $\pBHP$ is $\FPT$-complete.
\end{theorem}
\begin{proof}
  The underlying decision problem is in $\P$ (by a standard simulation on the deterministic universal Turing machine), so the parameterized problem is in $\FPT$.
  To show $\FPT$-hardness, we use a generic reduction.
  Let $(Q, \kappa)$ be an arbitrary parameterized problem in $\FPT$ and let $M$ be the deterministic Turing machine that decides $Q$ in time $f_M(k) n^c$ for some (circuit-)computable function $f_M$ and some positive integer $c$.
  The reduction is $x \mapsto (M, x, 1^{f_M(k) n^c}, c)$.
  This is computable by a (nonuniform) circuit family of constant depth and size $f(k) n^{O(1)}$, where $f$ is a circuit-computable function.
  The parameter of the reduced instance is $f_M(k) n^c / n^c$, or simply $f_M(k)$, which satisfies the parameter bound required by the definition of $\FPP$ reduction.
  Therefore we conclude that $\pBHP$ is $\FPP$-complete.
\end{proof}

The following problem is a generalization of the problem \textsc{BS-BD-CVP} from \autocite{cd98}.

\begin{definition}[$p\dash\textsc{Small Circuit Evaluation}$, aka $\pSCE$]
  \mbox{} \\
  \begin{tabular}{r p{9.2cm}}
    \textbf{Instance:} & single-output Boolean circuit $C$ on $n$ inputs, binary string $x$ of length $n$, positive integer $k$, positive integers $\alpha$ and $\beta$, multi-output Boolean circuits $f$ and $g$ on $\ceil{\log k}$ inputs with $\size(C) \leq f(k) n^\alpha$ and $\depth(C) \leq g(k) n^\beta$. \\
    \textbf{Parameter:} & $k$ \\
    \textbf{Question:} & Does $C(x) = 1$?
  \end{tabular}
\end{definition}

This theorem is related to \autocite[Corollary~2]{cd98}, where the authors prove that the \textsc{BS-BD-CVP} problem is complete for the class $\PNC$ (a class that lives between $\FPP$ and $\FPT$) under $\FPP$ many-one reductions.
While their reduction is a generic reduction, ours is a reduction from the parameterized bounded halting problem.

\begin{theorem}\label{thm:psce}
  $\pSCE$ is $\FPT$-complete.
\end{theorem}
\begin{proof}
  Membership in $\FPT$ is straightforward to prove: use the natural algorithm for evaluating a circuit which can be performed in linear time with respect to the size of the circuit.
  We must also compute $f(k) n^\alpha$ and $g(k) n^\beta$, and compare these with the size and depth of the circuit $C$.
  Both of these are polynomial-time algorithms with respect to the size of the input, and hence the problem is in $\FPT$.

%% %%%% Here we showed a generic reduction.
%%   Now we prove $\FPT$-hardness.
%%   Let $(Q, \kappa)$ be an arbitrary parameterized problem in $\FPT$, so there is a deterministic Turing machine $M$ that decides $Q$ in time $f(k) n^\alpha$ for some (circuit-)computable function $f$ and positive integer $\alpha$.
%%   Let $C_{M, n}$ be the Boolean circuit that correctly simulates the action of $M$ on inputs of size $n$ with size $O(f(k) n^\alpha)^2$ and depth $O(f(k) n^\alpha)$; such a circuit exists due to \autocite{???}.
%%   Define the circuit family $\{R_{n, k}\}$ as follows.
%%   \[
%%   R_{n, k}(x) = (C_{M, n}, x, 2\alpha, \alpha, f^2, f, k),
%%   \]
%%   where the natural number $n = |x|$, the positive integer $k = \kappa(x)$, and the function $f^2$ denotes the function $x \mapsto (f(x))^2$.
%%   Let us confirm that the reduced instance is well-formed.
%%   \begin{itemize}
%%   \item $C_{M, n}$ is a Boolean circuit on $n$ inputs.
%%   \item The size of $C_{M, n}$ is $f^2(k) n^{2 \alpha}$.
%%   \item The depth of $C_{M, n}$ is $f(k) n^\alpha$.
%%   \item Both $f^2$ and $f$ are circuit-computable since $f$ is circuit-computable.
%%   \end{itemize}
%%   (There are some constants in the size and depth bounds that we have ignored, but those can be incorporated into the circuit-computable function $f$.)
%%   The reduction is correct because
%%   \[
%%   x \in Q \iff M \text{ accepts } x \iff C_{M, n}(x) = 1.
%%   \]

%%   Next, we show that $R_{n, k}$ has the appropriate size and depth bounds to be a valid $\FPP$ many-one reduction.
%%   The only computation that needs to be done by the circuit is to compute $2 \alpha$ from $\alpha$ and to compute the circuit for $f^2$ from the circuit for $f$.
%%   However, since both $\alpha$ and $f$ are entirely independent of $n$, the size and depth are constants with respect to $|x|$.
%%   The remaining elements of the tuple (namely $C_{M, n}$, $\alpha$, $f$, and $k$) are hardcoded directly in the circuit $R_{n, k}$ and are output directly with no further computation.
%%   The input $x$ is output directly as well.
%%   The overall size of the circuit is therefore of the form $s(k) n^{O(1)}$, and the depth of the form $d(k) n^{O(1)}$.

%%   Finally, for the parameter bound, the parameter of $R_{n, k}(x)$ is $k$, which is exactly $\kappa(x)$.
%%   Therefore we have shown that the circuit family $\{R_{n, k}\}$ is a correct $\FPP$ many-one reduction from an arbitrary parameterized problem $(Q, \kappa)$ to $\pSCE$.
%% \end{proof}

%% \begin{theorem}
%%   $\pBHP \equiv_m^{\FPP} p \dash \textsc{Short Circuit Evaluation}$.
%% \end{theorem}
%% \begin{proof}
  Now we prove $\FPT$-hardness.
  The reduction from $\pBHP$ is
  \[
  (M, x, 1^t, c) \mapsto (C_M, x, \alpha, \beta, f, g, k),
  \]
  where
  \begin{itemize}
  \item $C_M$ is the standard circuit of size $O(t^2)$ and depth $O(t)$ simulating $t$ steps of the action of $M$ on inputs of length $n$,
  \item $\alpha = 2c$,
  \item $\beta = c$,
  \item $f$ is the function $x \mapsto x^2$,
  \item $g$ is the function $x \mapsto x$,
  \item $k = t / n^c$.
  \end{itemize}
  This reduction is computable in the appropriate size and depth bounds, and its correctness follows from the correctness of the standard deterministic Turing machine-to-circuit reduction.
  To check that the reduced instance is well-formed, let us verify that the circuit $C_M$ meets the size and depth requirements.
  The size of $C_M$ is $O(t^2)$, which is $O(((t / n^c) n^c)^2)$, or simply $f(k) n^\alpha$.
  Similarly the depth of $C_M$ is $O(t)$, which is $O((t / n^c) n^c)$, or simply $g(k) n^\beta$.
  (There are some constants in the size and depth bounds that we have ignored, but those can be incorporated into the circuit-computable functions $f$ and $g$.)
  Finally, the parameter in the original instance, $t / n^c$, is exactly the parameter of the reduced instance, so this reduction meets the necessary paramater bound.
  Therefore we have shown a correct $\FPP$ many-one reduction from an $\FPT$-complete problem.
\end{proof}

As expected, if any of these $\FPT$-complete problems are fixed-parameter parallelizable, then $\FPP = \FPT$.

It seems that most $\P$-complete problems will end up being $\FPT$-complete under this notion of completeness.
This doesn't really help us distinguish between different $\P$-complete problems based on how fixed-parameter parallelizable they are.
In the next subsection, we try a different approach.

\subsection{Parameterized complexity of efficient verification}

Consider the parameterized weighted circuit satisfiability and circuit evaluation problems.
A circuit is \emph{$k$-satisfiable} if there is a satisfying assignment of Hamming weight exactly $k$.

\begin{definition}[$p \dash \textsc{Circuit } k \dash \textsc{Satisfiability}$, aka $\pCkSAT$]
  \mbox{} \\
  \begin{tabular}{r p{9.2cm}}
    \textbf{Instance:} & Boolean circuit $C$, natural number $k$. \\
    \textbf{Parameter:} & $k$. \\
    \textbf{Question:} & Is $C$ $k$-satisfiable?
  \end{tabular}
\end{definition}

The corresponding parameterized weighted circuit evaluation problem would then be as follows.
Let $\|x\|_1$ denote the Hamming weight (that is, the number of ones) in $x$.

\begin{definition}[$\p \dash \textsc{Circuit } k \dash \textsc{Evaluation}$, aka $\pCkE$]
  \mbox{} \\
  \begin{tabular}{r p{9.2cm}}
    \textbf{Instance:} & Boolean circuit $C$, binary string $x$, natural number $k$. \\
    \textbf{Parameter:} & $k$. \\
    \textbf{Question:} & Does $\|x\|_1 = k$ and $C(x) = 1$?
  \end{tabular}
\end{definition}

This is a little silly, since the Hamming weight of $x$ can be computed trivially, but it is technically ``verification'' problem corresponding to the satisfiability problem above.
Instead, we use a problem that is equivalent but a little less silly.

\begin{definition}[$p \dash \textsc{Weighted Circuit Evaluation}$, aka $\pWCE$]
  \mbox{} \\
  \begin{tabular}{r p{9.2cm}}
    \textbf{Instance:} & Boolean circuit $C$, binary string $x$. \\
    \textbf{Parameter:} & $\|x\|_1$. \\
    \textbf{Question:} & Does $C(x) = 1$?
  \end{tabular}
\end{definition}

These parameterized problems are equivalent under $\FPP$ many-one reductions because the parameterization is computable in $\NC$.
\todo{Reference for circuit computing Hamming weight; see \url{http://ieeexplore.ieee.org/xpls/abs_all.jsp?arnumber=4781532}}

\begin{proposition}
  $\pCkE \equiv_m^{\FPP} \pWCE$.
\end{proposition}
%% \begin{proof}
%%   Let $\kappa_1$ denote the parameterization of the problem on the left and $\kappa_2$ the parameterization of the problem on the right.
%%   The right-to-left reduction is simply $(C, x) \mapsto (C, x, \|x\|_1)$.
%%   The correctness as well as the size, depth, and parameterization bounds are straightforward to prove.

%%   The circuit family computing the left-to-right reduction is $\{R_{m, k}\}$, defined by
%%   \[
%%   R_{m, k}(C, x, k) =
%%   \begin{cases}
%%     (C, x) & \text{if } \|x\|_1 = k \\
%%     (\textsc{not}, 1) & \text{otherwise},
%%   \end{cases}
%%   \]
%%   where $m$ denotes the overall size of the input and \textsc{not} is the circuit which is a single negation gate.

%%   In order to prove correctness, first suppose $C(x) = 1$ and $\|x\|_1 = k$.
%%   By construction, $R(C, x, k) = (C, x)$, and $C(x) = 1$, as required.
%%   For the converse, there are two cases to consider.
%%   First, if $C(x) \neq 0$, then the output of $R(C, x, k)$ will be a circuit that outputs zero regardless of the value of $\|x\|_1$.
%%   Second, if $\|x\|_1 \neq k$, then the output of $R(C, x, k)$ will be $(\textsc{not}, 1)$, which is a circuit that outputs zero.
%%   In either case, $R(C, x, k)$ is not in $\pwce$, as required.
%%   Thus the reduction is correct.

%%   The size and depth bounds are trivial since the circuit $R_{m, k}$ essentially just copies its input to its output.
%%   Finally, for the bound on the parameterization in the reduced instance, there are two cases.
%%   If $\|x\|_1 = k$, then
%%   \[
%%   $\kappa_2(R(C, x, k)) = \kappa_2(C, x) = \|x\|_1 = k = \kappa_1(C, x).
%%   \]
%%   Otherwise,
%%   \[
%%   \kappa_2(R(C, x, k)) = \kappa_2(\textsc{not}, 1) = 1 \leq \kappa_1(C, x).
%%   \]
%%   In either case, the parameterization of the reduced instance is bounded above by the parameterization of the original instance.
%%   Therefore we have shown the left-to-right $\FPP$ reduction.
%% \end{proof}

In the setting of decision problems, we know that $\NP$ can be characterized as the closure of the circuit satisfiability problem under polynomial-time many-one reductions,
\[
\NP = \cl{\textsc{Circuit Satisfiability}}^{\leq_m^\P},
\]
and $\P$ as the closure of the circuit evaluation problem under $\NC^1$ many-one reductions,
\[
\P = \cl{\textsc{Circuit Evaluation}}^{\leq_m^{\NC^1}}.
\]
In the setting of parameterized problems, the class $\W[P]$ can be characterized as the closure of the parameterized weighted circuit satisfiability problem under fixed-parameter tractable many-one reductions,
\[
\W[P] = \cl{\pCkSAT}^{\leq_m^{\FPT}}.
\]
Following the above pattern, we define a new class as the closure of the parameterized weighted circuit evaluation problem under fixed-parameter parallelizable many-one reductions,
\[
\E[P] = \cl{\pWCE}^{\leq_m^{\FPP}}
\]
("E" for evaluation).

Since the underlying decision problem, the problem of evaluating a circuit on a given input, is in $\P$, the parameterized problem $\pWCE$ is trivially in $\FPT$.
Since $\FPP$ reductions compose, $\FPP$ is a subset of $\FPT$, and $\FPT$ is closed under $\FPT$ reductions, we conclude that $\E[P]$ is a subset of $\FPT$.

\begin{theorem}
  $\E[P] \subseteq \FPT$.
\end{theorem}

Is $\E[P] = \FPT$?
The standard simulation of a deterministic Turing machine by a circuit, as in \autocite{ladner75}, for example, fails to provide a $\FPP$ many-one reduction to the parameterized weighted circuit evaluation problem, since the natural reduction would be of the form $x \mapsto (C, x, \|x\|_1)$, but the parameter value $\|x\|_1$ is not necessarily bounded by a function of $\kappa(x)$.
\todo{Show something bad happens if $\E[P] = \FPT$.}

\todo{Show a problem that is known to be in $\FPT$ (for example one of the deterministic Turing machine computation problems maybe) is actually in $\E[P]$.}

The same issue prevents us from showing that $\FPP \subseteq \E[P]$.

\section{\texorpdfstring{$\FPP$}{FPP} is to \texorpdfstring{$\NC$}{NC} as \texorpdfstring{$\WP$}{WP} is to \texorpdfstring{$\NNC$}{NNC}}

\subsection{Definition of \texorpdfstring{$\WP[P]$}{WP[P]}}

\begin{definition}[{$\WP^d[P]$}]
  Let $d$ be a natural number.
  A parameterized problem $(Q, \kappa)$ is in the class $\WP[P]^d$ if there are circuit-computable functions $f$, $g$, and $h$, and a nondeterministic circuit family $\{C_{n, k}\}$ such that for each string $x$,
  \begin{itemize}
  \item $x \in Q$ if and only if $C_{n, k}(x) = 1$, where $n = |x|$ and $k = \kappa(x)$,
  \item $\size(C_{n, k}) \leq f(k) n^{O(1)}$,
  \item $\depth(C_{n, k}) \leq g(k) \log^d n$,
  \item $\nondet(C_{n, k}) \leq h(k) \log n$.
  \end{itemize}
\end{definition}

\subsection{Example problems in \texorpdfstring{$\WP[P]$}{WP[P]}}
\label{sec:rankinwp}

What kind of problems are in the class $\WP[P]$?

\begin{definition}[$\textsc{Group Rank}$]
  \mbox{} \\
  \begin{tabular}{r p{9.2cm}}
    \textbf{Instance:} & finite group $G$ given as a product table, positive integer $k$. \\
    \textbf{Question:} & Does $G$ have a generating set of cardinality $k$?
  \end{tabular}
\end{definition}

Let $\pgrouprank$ denote the standard parameterization of $\textsc{Group Rank}$.

\begin{theorem}
  $\pgrouprank$ is in $\WP^1[P]$.
\end{theorem}
\begin{proof}
  The (unparameterized) language $\textsc{Group Rank}$ is in $\beta_2 \FOLL$ \autocite[Theorem~4.2]{grouprank}.
  The algorithm nondeterministically chooses a set of $k$ group elements, each requiring $O(\log n)$ bits to represent, then (deterministically) verifies that the set generates the entire group.
  Thus there is a nondeterministic circuit family that decides $\textsc{Group Rank}$ with (parameter-less) size and depth bounds of $n^{O(1)}$ and $\log \log n$, respectively, and using $O(k) \log n$ nondeterministic bits.
  Therefore the parameterized problem is in $\WP^1[P]$.
\end{proof}

This is the $\NC^d$ bounded version of the parameterized problem from \autocite[Lemma~3.26]{fg06}.

\begin{definition}[$\pncsat$]
  \mbox{} \\
  \begin{tabular}{r p{9.2cm}}
    \textbf{Instance:} & Boolean circuit $C$ on $n$ inputs, with size $m$ and depth $O(\log^d n)$. \\
    \textbf{Parameter:} & $n / \log m$. \\
    \textbf{Question:} & Is $C$ satisfiable?
  \end{tabular}
\end{definition}

\begin{lemma}\label{lem:pncsat}
  $\pncsat$ is in $\WP^d[P]$.
\end{lemma}
\begin{proof}
  The depth-universal circuit $U$ of \autocite{ch85} proves membership of this problem in $\WP^d[P]$.
  The number of nondeterministic bits required by the universal circuit is simply $n$, the size of the input to the circuit $C$, which is of the form $h(k) \log m$ if we choose $h(k) = k = n / \log m$ where $k = \kappa(x)$.
\end{proof}

\subsection{Example problem complete for \texorpdfstring{$\WP[P]$}{WP[P]}}

\todo{If we show a complete problem here, make sure to give a corollary in the section below that it is not in FPP unless something bad happens.}

\subsection{Does \texorpdfstring{$\FPP$}{FPP} equal \texorpdfstring{$\WP[P]$}{WP[P]}?}
\label{sec:fppwpp}

The next theorem is similar to \autoref{thm:eventually} in that it is a characterization of $\WP^d[P]$, a nondeterministic extension of $\FPP^d$.
It is the adaptation of \autocite[Proposition~3.7]{fg06}.
The parameterized problems in $\WP^d[P]$ of most interest to us are those for which there is a nondeterministic $\NC$ algorithm with nondeterminism limited by a function of the parameter.

\todo{
  There's some wiggle room with this theorem: if we change the definition of $\WP^d[P]$ to have depth $g(k) + \log^d n$, then we can get $\NNC^d$ instead of $\NNC^{d + e}$ in the conclusion.
  This sort of depth bound appears in \autocite{bst15}.
}

\begin{theorem}\label{thm:rmparam}
  Suppose $d$ is a natural number, $e$ is a positive integer, and $(Q, \kappa)$ is a parameterized problem.
  %% If e = 0, then we get a divide-by-zero error.
  If $(Q, \kappa) \in \WP^d[P]$ and $Q \in \NNC^d[\poly]$, then there is a nondeterministic $\NC^{d + e}$ circuit family $\{C_{n, k}\}$ and a circuit-computable function $h$ such that $\{C_{n, k}\}$ decides $Q$ and $\nondet(C_{n, k}) \leq h(k) \log n$.
  %% The converse holds when $e = 0$.
\end{theorem}
\begin{proof}
  Assume $(Q, \kappa) \in \WP^d[P]$ and $Q \in \NNC^d[\poly]$.
  Define the circuit family $\{A_{n, k}\}$ by
  \[
  A_{n, k} =
  \begin{cases}
    C^1_{n, k} & \text{if } f_1(k) \leq n \text{ and } g_1(k) \leq \log^e n \\
    C^2_n & \text{otherwise},
  \end{cases}
  \]
  where
  \begin{itemize}
  \item $\{C^1_{n, k}\}$ is the $\WP^d[P]$ circuit family,
  \item $f_1$ and $g_1$ are the circuit-computable functions on the parameter that appear in the size and depth bounds, respectively, for $C^1_{n, k}$,
  \item $\{C^2_n\}$ is the $\NNC^d[\poly]$ circuit family.
  \end{itemize}
  The fact that $A_{n, k}$ correctly decides $Q$ follows from the correctness of the circuits $C^1_{n, k}$ and $C^2_n$.
  It remains to show that $A_{n, k}$ has the required size, depth, and nondeterminism bounds.

  If $f_1(k) \leq n$ and $g_1(k) \leq \log^e n$, then
  \begin{align*}
    \size(A_{n, k}) & \leq \size(C^1_{n, k}) \leq f_1(k) n^{O(1)} \leq n^{O(1)} \\
    \depth(A_{n, k}) & \leq \depth(C^1_{n, k}) \leq g_1(k) \log^d n \leq \log^{d + e} n,
  \end{align*}
  and otherwise
  \begin{align*}
    \size(A_{n, k}) & \leq \size(C^2_n) \leq n^{O(1)} \\
    \depth(A_{n, k}) & \leq \depth(C^2_n) \leq \log^d n.
  \end{align*}
  The overall size and depth upper bounds for $A_{n, k}$ are thus $n^{O(1)}$ and $O(\log^{d + e} n)$, respectively.

  For the nondeterminism, there are three cases.
  First, if $f_1(k) \leq n$ and $g_1(k) \leq \log^e n$, then
  \[
  \nondet(A_{n, k}) \leq \nondet(C^1_{n, k}) \leq h_1(k) \log n,
  \]
  where $h_1$ is the circuit-computable of the parameter that appears in the nondeterminism bound for $C^1_{n, k}$.
  Second, if $f_1(k) > n$, then
  \[
  \nondet(A_{n, k}) \leq \nondet(C^2_n) \leq n^{O(1)} \leq f_1(k)^{O(1)}.
  \]
  Finally, if $g_1(k) > \log^e n$, then $2^{(g_1(k))^{1 / e}} > n$, which implies
  \[
  \nondet(A_{n, k}) \leq \nondet(C^2_n) \leq n^{O(1)} \leq 2^{O((g_1(k))^{1 / e})}.
  \]
  If we choose $h(k) = \max\{ h_1(k), f_1(k)^{O(1)}, 2^{O((g_1(k))^{1 / e})} \}$, then we can conclude $\nondet(A_{n, k}) \leq h(k) \log n$.
\end{proof}

\begin{assumption}\label{ass:complete}
  There is a parameterized problem $(Q, \kappa)$ complete for $\WP^d[\P]$ under $\FPP^d$ many-one reductions such that $Q \in \NNC^d[\poly]$.
\end{assumption}

This theorem is an adaptation of one direction of \autocite[Theorem~3.29]{fg06}.

\begin{theorem}[Theorem~3.29, part i]\label{thm:wppparti}
  Assume \autoref{ass:complete}.
  Suppose $d$ is a natural number and $e$ is a positive integer.
  If there is a circuit-computable, nondecreasing, unbounded function $i$ such that $\NC^d = \NNC^{d + e}[i(n) \log n]$, then $\FPP^d = \WP^d[P]$.
  \todo{Does $i$ need to be computable here?}
\end{theorem}
\begin{proof}
  Assume $\NC^d = \NNC^{d + e}[i(n) \log n]$.
  By \autoref{ass:complete}, let $(Q, \kappa)$ be a parameterized problem complete for $\WP^d[P]$ with $Q \in \NNC^d[\poly]$.
  \todo{
    Ideally, the p-NC SAT problem should be complete for $\WP^d[P]$ too (this would prove the assumption above), and then we could use that problem both here and in the proof of the other direction of the theorem.
    But the problem comes in the reduction from an arbitrary parameterized problem to this one: the circuit depth needs to be polylogarithmic, but it may be larger.
    Perhaps we can use the other complete problems from \autocite{cc97lim} here?
  }
  By \autoref{thm:rmparam}, there is a circuit-computable function $h$ and an $\NNC^{d + e}$ circuit family $\{C_{n, k}\}$ such that $\nondet(C_{n, k}) \leq h(k) \log n$.

  Let $f$ be a circuit-computable function such that $n \geq f(k)$ implies $h(k) \leq i(n)$.
  \todo{Explain why such an $f$ must exist.}
  Now consider the set $Q^+$, defined by
  \[
  Q^+ = Q \cap \left\{ x \, \middle| \, |x| \geq f(\kappa(x)) \right\}.
  \]
  Since $|x| \geq f(\kappa(x))$ for each $x \in Q^+$, we have $h(\kappa(x)) \leq i(|x|)$.
  Thus $Q^+$ is in $\NNC^{d + e}[i(n) \log n]$.
  By assumption, $Q^+$ is therefore also in $\NC^d$.
  This means $Q$ is eventually in $\NC^d$, so we have $Q \in \FPP^d$ by \autoref{thm:eventually}.
\end{proof}

This lemma is an adaptation of \autocite[Lemma~3.24]{fg06}.
It is the ``opposite'' of \autoref{lem:upperinverse}.

\begin{lemma}\label{lem:lowerinverse}
  Suppose $e$ is a positive integer and $f$ and $g$ are increasing, circuit-computable functions.
  %% If e is 0, then i_{g, e} is not unbounded.
  There are functions $i_f$ and $i_{g, e}$ such that
  \begin{itemize}
  \item $f(i_f(n)) \leq n$ for each $n \geq f(1)$,
  \item $g(i_{g, e}(n)) \leq \log^e n$ for each $n \geq g(1)$.
  \end{itemize}
  Furthermore, these functions are circuit-computable, nondecreasing, unbounded.
\end{lemma}
\begin{proof}
  Define $i_f$ by
  \[
  i_f(n) = \begin{cases}
    \max\{ j \in \mathbb{N} \, | \, f(j) \leq n\} & \text{if } n \geq f(1) \\
    1 & \text{otherwise},
  \end{cases}
  \]
  and $i_{g, e}$ by
  \[
  i_{g, e}(n) = \begin{cases}
    \max\{ j \in \mathbb{N} \, | \, g(j) \leq \log^e n\} & \text{if } n \geq g(1) \\
    1 & \text{otherwise}.
  \end{cases}
  \]
  It is straightforward to prove that these functions are nondecreasing and unbounded.

  To compute $i_f$, we use the fact that $f$ is increasing to perform a binary search on the values $f(1), \dotsc, f(n)$ to determine the largest $j$ such that $f(j) \leq n$.
  There will be $\log n$ comparison subcircuits, each requiring a computation of $f$, so the overall depth of the circuit computing $i_f$ is $O(\depth(f) \log n)$ and the size is $O(\size(f) \log n)$.
  Computing $i_{g, e}$ is similar, but the multiplicative factor to the size and depth of $g$ is $O(e \log \log n)$ instead of $O(\log n)$.
\end{proof}

This is an adaptation of the other direction of \autocite[Theorem~3.29]{fg06}.

\begin{theorem}\label{thm:wpppartii}
  Suppose $e$ is a positive integer.
  If $\FPP^d = \WP^d[P]$, then there is a circuit-computable, nondecreasing, unbounded function $i$ such that $\NC^{d + e} = \NNC^d[i(n) \log n]$.
\end{theorem}
\begin{proof}
  Assume $\FPP^d = \WP^d[P]$.
  Since $\pncsat$ is in $\WP^d[P]$ by \autoref{lem:pncsat}, it is now in $\FPP^d$ as well.
  We will use \autoref{lem:reducetonc} to show a reduction meeting the criteria of that lemma from an arbitrary decision problem $Q$ in $\NNC^d[i(n) \log n]$ to $\pncsat$.
  \todo{Could we use a complete problem here instead of an arbitrary problem?}

  Let $\{C_{m, k'}\}$ be the deterministic circuit family deciding the parameterized problem $\pncsat$ and $f$ and $g$ the circuit-computable functions such that
  \begin{itemize}
  \item for each instance $D$, we have $D \in \NC^d\textnormal{-}\textsc{Circuit Sat}$ if and only if $C_{m, k'}(D) = 1$,
  \item $\size(C_{m, k'}) \leq f(k') m^{O(1)}$,
  \item $\depth(C_{m, k'}) \leq g(k') \log^d m$.
  \end{itemize}
  Assume without loss of generality that $f$ and $g$ are increasing.
  Let $i_f$ and $i_{g, e}$ be the functions corresponding to $f$ and $g$, respectively, guaranteed by \autoref{lem:lowerinverse}.
  Let $i(n) = \min(i_f(n), i_{g, e}(n))$, for each natural number $n$.

  Let $Q \in \NNC^d[i(n) \log n]$.
  Suppose $\{D_n\}$ is the family of $\NNC^d[i(n) \log n]$ circuits that decides $Q$.
  For each input $x$, let $D_x$ denote $D_n$ with $x$ hardcoded.
  Whereas the circuit $D_n$ has $n + i(n) \log n$ inputs, the circuit $D_x$ has $i(n) \log n$ inputs.

  Let $R_n$ be the circuit-computable function $x \mapsto D_x$, where $n$ denotes the length of $x$.
  The circuit family $\{R_n\}$ is an $\NC^d$ many-one reduction
  Then
  \begin{itemize}
  \item for each $x$, we have $x \in Q$ if and only if $D_x$ is satisfiable,
  \item $\size(R_n) \leq O(\size(D_x)) = O(\size(D_n)) = n^{O(1)}$,
  \item $\depth(R_n) \leq O(1)$.
  \end{itemize}
  Now we have the two main ingredients required for \autoref{lem:reducetonc}, an $\NC^d$ many-one reduction and an $\FPP^d$ algorithm.
  It remains to show $f(\kappa'(R_n(x))) \leq n^{O(1)}$ and $g(\kappa'(R_n(x))) \leq O(\log^e n)$.
  This is true because
  \begin{align*}
    f(\kappa'(R_n(x))) & = f(\kappa'(D_x)) \\
    & = f\left(\frac{i(n) \log n}{\log m}\right) \\
    & \leq f\left(\frac{i_f(n) \log n}{\log n}\right) \\
    & \leq f(i_f(n)) \\
    & \leq n,
  \end{align*}
  and
  \begin{align*}
    g(\kappa'(R_n(x))) & = g(\kappa'(D_x)) \\
    & = g\left(\frac{i(n) \log n}{\log m}\right) \\
    & \leq g\left(\frac{i_{g, e}(n) \log n}{\log n}\right) \\
    & \leq g(i_{g, e}(n)) \\
    & \leq \log^e n. \qedhere
  \end{align*}
\end{proof}

\subsection{Is \texorpdfstring{$\WP[P]$}{WP[P]} in \texorpdfstring{$\FPT$}{FPT}?}

\todo{Maybe relax the theorem above.}

\subsection{Does WP[P] equal W[P]?}

\begin{theorem}
  $\WP[P] \subseteq \W[P]$.
\end{theorem}
\begin{proof}
  This follows from the usual simulation of a circuit by a Turing machine, which can be done in linear time with respect to the size of the circuit.
  The number of nondeterministic bits required by the Turing machine is exactly the same as the number required by the circuit.
\end{proof}

Whether the converse inclusion holds is not so clear.

\begin{conjecture}
  $\WP[P] \subsetneq \W[P]$ unless $\NC = \P$.
\end{conjecture}
\begin{justification}
  If we use our intuition that $\WP[P]$ is like $\NNC[\poly]$ and $\W[P]$ is like $\NP$, then we might expect $\WP[P] = \W[P]$, since $\NNC[\poly] = \NP$ \autocite[Theorem~2.2]{wolf94}.
  However, the technique used to show $\NP \subseteq \NNC[\poly]$ requires the use of $t(n)^2$ nondeterministic bits, where $t(n)$ is the running time of the nondeterministic Turing machine (which is $f(k) n^{O(1)}$ in this case).
  Other approaches I attempted face a similar problem.
  I suspect instead that $\WP[P] = \W[P]$ if and only if $\NC = \P$, similar to the way $\NNCO = \NPO$ \autocite{ncapproximation} if and only if $\NC = \P$.
\end{justification}

\section{The \texorpdfstring{$\WP$}{WP} hierarchy}

For the necessary background in logic, see \autocite[Chapter~4]{fg06}.

\subsection{Definition of \texorpdfstring{$\WP[t]$}{WP[t]}}

Let $\Phi$ be a class of formulas and let $\phi$ be an element of $\Phi$ with one free relation variable $X$ of arity $s$.
Define the weighted definability problem and the corresponding parameterized problem as follows.

\begin{definition}[{$\WD_\phi$ \autocite[Section~4.3]{fg06}}]
  \mbox{} \\
  \begin{tabular}{r p{9.2cm}}
    \textbf{Instance:} & structure $\mathcal{A}$, natural number $k$. \\
    \textbf{Question:} & Is there an $S \subseteq A^s$ such that $|S| = k$ and $\mathcal{A} \models \phi(S)$?
  \end{tabular}
\end{definition}

\begin{definition}[{$p\textnormal{-}\WD_\phi$ \autocite[Section~5.1]{fg06}}]
  \mbox{} \\
  \begin{tabular}{r p{9.2cm}}
    \textbf{Instance:} & structure $\mathcal{A}$, natural number $k$. \\
    \textbf{Parameter:} & $k$ \\
    \textbf{Question:} & Is there an $S \subseteq A^s$ such that $|S| = k$ and $\mathcal{A} \models \phi(S)$?
  \end{tabular}
\end{definition}

This definition is adapted from \autocite[Definition~5.1]{fg06}.

\begin{definition}
  For each natural number $d$ and positive integer $t$, let $WP^d[t] = []$...
\end{definition}

\todo{theorem: level t is in level t + 1, and each level is in WP[P]}

%% %% These definitions are used for the A[t] and A[P] hierarchy.

%% \begin{definition}[{$\MC(\Phi)$ \autocite[Section~4.3]{fg06}}]
%%   \mbox{} \\
%%   \begin{tabular}{r p{9.2cm}}
%%     \textbf{Instance:} & structure $\mathcal{A}$, formula $\phi \in \Phi$. \\
%%     \textbf{Question:} & Does $\mathcal{A} \models \phi$?
%%   \end{tabular}
%% \end{definition}

%% \begin{definition}[{$p\textnormal{-}\MC(\Phi)$ \autocite[Section~5.2]{fg06}}]
%%   \mbox{} \\
%%   \begin{tabular}{r p{9.2cm}}
%%     \textbf{Instance:} & structure $\mathcal{A}$, formula $\phi \in \Phi$. \\
%%     \textbf{Parameter:} & $|\phi|$ \\
%%     \textbf{Question:} & Does $\mathcal{A} \models \phi$?
%%   \end{tabular}
%% \end{definition}

\subsection{Example problem in \texorpdfstring{$\WP[t]$}{WP[t]}}

\todo{Show a natural problem that is actually in a finite level of the hierarchy here; the group rank problem is not.}
\todo{For the semigroup rank problem, the problem is complete for $\textnormal{para} \dash \WNL$ \autocite{est15}}.

In \autoref{sec:rankinwp}, we proved that $\pgrouprank$ is in $\WP^1[P]$.
Is this problem in a fixed finite level of the $\WP$ hierarchy?
%% Let us try to express this problem in first-order logic.
%%
%% \begin{definition}[Axiomatization of groups]
%%   The signature for groups has a constant symbol for the identity element denoted $e$, a unary function for the inverse denoted $x^{-1}$, and a binary function for the group operation (denoted by concatenation).
%%   Let the group axioms be defined as first-order formulae as follows.
%%   \begin{align*}
%%     \textsc{HasIdentity} & = \forall x\, (ex = x \land xe = x) \\
%%     \textsc{HasInverses} & = \forall x\, (x^{-1} x = x x^{-1} = e) \\
%%     \textsc{IsAssociative} & = \forall x \forall y \forall z\, ((x y) z = x (y z))
%%   \end{align*}
%%   Let $\textsc{IsGroup}$ be the conjunction of these three formulae.
%%   Now for any finite structure $\mathcal{A}$, we have $\mathcal{A} \models \textsc{IsGroup}$ if and only if $\mathcal{A}$ is a group.
%%   Let $\textsc{Group}$ denote the class of all finite structures that are valid groups, that is, the class of all structures that model $\textsc{IsGroup}$.
%%   (Since the universal quantifiers can be placed in the beginning of the formula, $\textsc{IsGroup}$ is a $\Pi_1$ formula.)
%% \end{definition}
Unfortunately, the best first-order formulas that describe this problem are not of the form $\Sigma_k$ for some finite natural number $k$.
In general, the number of variables grows with the order of the group.
\begin{itemize}
\item
  There is a first-order formula that has $O(1)$ variables, but $O(\log n)$ quantifier alternations, using the strategy from the $\PSPACE$-completeness of $\textsc{TQBF}$ \autocite[Lemma~2.3]{nt16}.
  This places the problem in $\FO[\log n]$, which is $\AC^1$, but doesn't provide placement in any finite level of the $\WP$ hierarchy.
\item
  The authors of \autocite{bklm01} were not able to show membership in $\FO[\log \log n]$, which would have slightly improved the above membership, but still wouldn't place the problem in a finite level of the $\WP$ hierarchy.
\item
  There is a first-order formula that has two alternations (beginning with $\forall$), but $O(\log n)$ variables \autocite[Lemma~3.5]{nt16}.
  The fact that the number of variables grows with the size of the input means this does not place the problem in any descriptive complexity class, nor any parameterized complexity class.
\item
  There is a $\FO[\DTC]$ formula for the problem, since group membership is in $\L$, which equals $\FO[\DTC]$.
  Although this subsumes the membership in $\FO[\log n]$ given in the first item above, this does not help us place the problem in a parameterized complexity class.
\end{itemize}
This basically means that the problem is in $\WP[\log n]$.

\subsection{Example problem complete for \texorpdfstring{$\WP[t]$}{WP[t]}}

\todo{If we show a complete problem here, make sure to give a corollary in the section below that it is not in FPP unless something bad happens.}

\subsection{Does \texorpdfstring{\FPP}{FPP} equal \texorpdfstring{\WP[t]}{WP[t]}?}

\begin{theorem}\label{thm:picsatgc}
  Suppose $t$ is a positive integer with $t \geq 2$ and $i$ is a circuit-computable nondecreasing function.
  $\PiCSAT$ is complete for $\GC[i(n) \log n, \Pi_t]$ under $\NC^d$ many-one reductions.
\end{theorem}
\begin{proof}
  \todo{Fill me in...}
\end{proof}

\begin{theorem}\label{thm:ppifsat}
  $\pPiFSAT$ is complete for $\WP^d[t]$ under $\FPP^d$ many-one reductions.
\end{theorem}
\begin{proof}
  \todo{Fill me in...}
\end{proof}

This theorem is an adaptation of one direction of \autocite[Theorem~4.3]{cc97npo}.
It is a translation of \autoref{thm:wppparti} to the finite levels of the $\WP$ hierarchy.
\todo{discuss that $\Pi_t \LOGTIME$ is in $\AC^0$, and therefore is strictly weaker than $\NC^1$; see similar discussion at the end of \autocite{cc97npo}.}

\begin{theorem}\label{thm:wptparti}
  Suppose $d$ and $t$ are positive integers with $t \geq 2$.
  If there is a circuit-computable, nondecreasing, unbounded function $i$ such that
  \[
  \GC[i(n) \log n, \Pi_t \LOGTIME] \subseteq \NC^d,
  \]
  then $\FPP^d = \WP^d[t]$.
\end{theorem}
\begin{proof}
  Assume $\GC[i(n) \log n, \Pi_t \LOGTIME] \subseteq \NC^d$.
  Since $\PiCSAT$ is in the class $\GC[i(n) \log n, \Pi_t \LOGTIME]$ by \autoref{thm:picsatgc}, it is now in $\NC^d$ as well.

  Since $\pPiFSAT$ is complete for $\WP^d[t]$ under $\FPP^d$ many-one reductions by \autoref{thm:ppifsat}, it suffices to show that $\pPiFSAT$ is in $\FPP^d$.
  Furthermore, by \autoref{lem:spreduction}, it suffices to show that there is a small parameter $\NC^d$ many-one reduction from $\pPiFSAT$ to $\PiCSAT$.

  Let $\{R_n\}$ be the family of circuits computing the function $\phi \mapsto C_\phi$, where $\phi$ is a $\Pi_t$-normalized Boolean formula and $C_\phi$ is the natural $\Pi_t$ Boolean circuit induced by that formula.
  If we can show that $R_n$ is in $\NC^d$, then the parameter upper bound $i$ and $\{R_n\}$ together comprise a small parameter $\NC^d$ many-one reduction from $\pPiFSAT$ to $\PiCSAT$.

  Transforming a formula to its equivalent circuit is certainly computable in logarithmic space, so it is certainly in $\NC^2$.
  However, we can transform a Boolean formula into an equivalent Polish notation (prefix) Boolean formula in alternating logarithmic time \autocite{buss87}, which is in $\NC^1$, and from there we can write the adjacency matrix of the tree given by the prefix Boolean formula with an $\NC^1$ algorithm.
\end{proof}

Compare this corollary with \autoref{thm:wppparti}.

\begin{corollary}
  Suppose $d$ and $t$ are positive integers with $t \geq 2$.
  If there is a circuit-computable, nondecreasing, unbounded function $i$ such that $\NC^d = \NNC^d[i(n) \log n]$, then $\FPP^d = \WP^d[t]$.
\end{corollary}
\begin{proof}
  The class $\Pi_t \LOGTIME$ is a subclass of $\AC^0$, which is a subclass of $\NC^1$.
  Thus $\GC[i(n) \log n, \Pi_t \LOGTIME] \subset \NNC^1[i(n) \log n]$.
  Therefore, the inclusion $\NNC^1[i(n) \log n] \subseteq \NC^d$ implies \autoref{thm:wptparti}.
\end{proof}

\begin{lemma}\label{lem:circuittoformula}
  Suppose $t$ is a positive integer.
  There is an $\NC^2$ many-one reduction from $\PiCSAT$ to $\PiFSAT$.
  Furthermore, the reduction preserves witnesses in the following (strong) sense.
  For each circuit $C$, if $\phi$ is the image of $C$ under the reduction, then $\Var(C) = \Var(\phi)$ and for each input vector $x$, we have $C(x) = 1$ if and only if $\phi(x) = 1$.
\end{lemma}
\begin{proof}
  The reduction operates as follows on input $(C, k)$, where $C$ is a Boolean circuit of size $m$ and depth $t$ and $k$ is a positive integer.
  Construct a trie (also known as a prefix tree) from the $O(m^t)$ possible paths from output gate to input gate, then output $(\phi, k)$, where $\phi$ is the Boolean formula represented by the constructed trie.
  The output gate is the root of the trie, the internal gates are the internal nodes of the tree, and the input gates are the leaf nodes of the trie (one leaf node for each input gate).
  By construction, the formula has the same set of variables as the circuit, and any path from output gate to input gate in the circuit has the same labels as the corresponding path in the trie, so for any input $x$, we have $C(x) = \phi(x)$.
  This also implies that $C$ has a satisfying assignment of weight $k$ if and only if $\phi$ has a satisfying assignment of weight $k$.

  Constructing a trie from $O(m^t)$ binary strings can be done by a circuit with $O(\log m^t)$ time and $O(m^{2t})$ size \autocite{lv86} (\todo{someone needs to verify this}).
  Since each ``character'' in our ``strings'' is really an element of $\{1, \dotsc, m\}$, there is an extra $O(\log m)$ depth penalty for reducing an alphabet of size $m$ to the binary alphabet.
  Thus the overall depth is $O(t \log^2 m)$ and the size $O(m^{2t} \log m)$.
  Since $t$ is a constant with respect to the size of the input $C$, this is an $\NC^d$ circuit.
\end{proof}

This theorem is an adaptation of the other direction of \autocite[Theorem~4.3]{cc97npo}.
It is a translation of \autoref{thm:wpppartii} to the finite levels of the $\WP$ hierarchy.

\begin{theorem}
  Suppose $d$, $e$, and $t$ are positive integers with $t \geq 2$.
  If $\FPP^d = \WP^d[t]$, then there is a circuit-computable, unbounded, nondecreasing function $i$ (that depends on $e$) such that %% $i(n) \leq n$ and
  $\GC[i(n) \log n, \Pi_t \LOGTIME] \subseteq \NC^{d + e}$.
\end{theorem}
\begin{proof}
  Assume $\FPP^d = \WP^d[t]$.
  Since $\pPiFSAT$ is in $\WP^d[t]$ by \autoref{thm:ppifsat}, it is now in $\FPP^d$ as well.
  We will use \autoref{lem:reducetonc} to show a reduction meeting the criteria of that lemma from $\PiCSAT$, which is complete for the class $\GC[i(n) \log n, \Pi_t \LOGTIME]$ under $\NC^d$ reductions by \autoref{thm:picsatgc}, to $\pPiFSAT$.

  Let $\{C_{m, k'}\}$ be the deterministic circuit family deciding $\pPiFSAT$ and $f$ and $g$ the circuit-computable functions such that
  \begin{itemize}
  \item for each $\phi$, we have $\phi$ is satisfiable if and only $C_{m, k'}(\phi) = 1$
  \item $\size(C_{m, k'}) \leq f(k') m^{O(1)}$,
  \item $\depth(C_{m, k'}) \leq g(k') \log^d m$.
  \end{itemize}
  Assume without loss of generality that $f$ and $g$ are increasing.
  Let $i_f$ and $i_{g, e}$ be the functions corresponding to $f$ and $g$, respectively, guaranteed by \autoref{lem:lowerinverse}.
  Let $i(n) = \min(i_f(n), i_{g, e}(n))$, for each natural number $n$.

  For the chosen function $i$, consider the problem $\PiCSAT$.
  By \autoref{lem:circuittoformula}, there is an $\NC^d$ reduction, $\{R_n\}$, from $\PiCSAT$ to $\PiFSAT$, the decision problem underlying the parameterized problem $\pPiFSAT$.
  Furthermore, since the variables and the satisfying assignments are identical, we have
  \begin{align*}
    f(\kappa'(R_n(C, k))) & = f(\kappa'(\phi, k)) \\
    & \leq f(k) \\
    & \leq f(i(n)) \\
    & \leq f(i_f(n)) \\
    & \leq n,
  \end{align*}
  and
  \begin{align*}
    g(\kappa'(R_n(C, k))) & = g(\kappa'(\phi, k)) \\
    & \leq g(k) \\
    & \leq g(i(n)) \\
    & \leq g(i_{g, e}(n)) \\
    & \leq O(\log^e n).
  \end{align*}
  Thus the many-one reduction from \autoref{lem:circuittoformula} and the $\FPP^d$ algorithm for $\pPiFSAT$ meet the conditions in the premise of \autoref{lem:reducetonc}.
  We conclude that $\PiCSAT$ is in $\NC^{d + e}$.
\end{proof}

\subsection{Is WP[t] in FPT?}

\todo{May be able to relax the proof of the previous subsection in order to show similar (negative) consequences.}

\subsection{Does WP[t] = W[t]?}

\todo{I think no, unless P = NC; prove it.}

%% Print the bibliography section here.
\printbibliography

\end{document}
